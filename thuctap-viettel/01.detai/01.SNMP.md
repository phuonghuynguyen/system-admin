<h1 style="color:orange">SNMP</h1>
SNMP (Simple Network Monitoring Protocol). Nó là một giao thức để truyền thông tin quản lý trong mạng, đặc biệt là sử dụng trong mạng LAN.

Hầu hết các thiết bị giám sát hiện nay đều sử dụng SNMP.

Các phiên bản của giao thức SNMP:<br>
Hiện tại, có ba (03) phiên bản chính của SNMP.<br> 
- Phiên bản đầu tiên được phát triển khá nhanh vào cuối những năm 80 khi quản trị mạng thiếu các công cụ quản trị mạng phù hợp không phụ thuộc vào các nhà sản xuất phần cứng.
SNMP v1 được định nghĩa vào năm 1988 và dựa trên SGMP (RFC 1028). Sau đó, nó đã được chấp nhận và sử dụng rộng rãi. Nó vẫn được sử dụng cho đến ngày nay, gần 30 năm sau. Hạn chế lớn nhất của v1 là kiến ​​trúc bộ đếm 32 bit (32-bit Counter Architecture), không đủ cho các mạng gigabyte ngày nay hoặc lớn hơn.
- SNMP v2 hỗ trợ bộ đếm 64 bit nhưng vẫn gửi dữ liệu quan trọng dưới dạng văn bản (Text), vì vậy nó không thực sự tăng cường bảo mật.
-  Được định nghĩa vào năm 2002, SNMP v3 bao gồm các ưu điểm của SNMP v2c và bổ sung các giải pháp bảo mật như tài khoản người dùng (User Accounts), xác thực (Authentication) và mã hóa (Encryption) tùy chọn các gói dữ liệu. Điều này tăng cường bảo mật và làm cho SNMP v3 trở thành phiên bản SNMP được đề xuất khi nói đến bảo mật. Tuy nhiên, nó cũng khiến việc cấu hình trở nên khó khăn hơn, cụ thể là quản lý người dùng. Do đó, cần nhiều sức mạnh xử lý hơn, đặc biệt là với các khoảng thời gian giám sát ngắn tạo ra một số lượng lớn các bản tin SNMP.
<h2 style="color:orange">1. SNMP hoạt động như thế nào</h2>
Một mạng thường có 1 máy chủ giám sat và các client. Ví dụ như nagios, zabbix, prometheus, ... máy chủ giám sát thường lưu dữ liệu giám sát vào 1 DB (MySQL,MariaDB,...). Những dữ liệu này được gửi từ các "agent" cài trên các client để lấy metrics (thông số dữ liệu client).

Về cơ bản, việc quản lý dựa trên công nghệ push và pull. Ví dụ server quản lý gửi yêu cầu thu thập phản hồi từ máy chủ hoặc thiết bị được quản lý. Các client có agent phản hồi và thông báo khi có sự kiện.
<h2 style="color:orange">1.1.Các bản tin trong SNMP</h2>

- `GetRequest` - Đây là loại tin nhắn SNMP phổ biến nhất mà trình quản lý SNMP gửi đi để yêu cầu dữ liệu. Thiết bị mục tiêu sẽ trả về giá trị được yêu cầu cùng với tin nhắn phản hồi “Response”.
- `GetNextRequest` - Trình quản lý SNMP có thể gửi loại tin nhắn này để khám phá thông tin nào có sẵn từ thiết bị. Bằng cách bắt đầu từ OID 0, trình quản lý có thể tiếp tục gửi yêu cầu cho dữ liệu có sẵn tiếp theo cho đến khi không còn dữ liệu “tiếp theo”.
- `GetBulkRequest` - Được thêm vào SNMP Phiên bản 2, đây là phiên bản mới hơn, được tối ưu hóa của yêu cầu GetNextRequest. Về cơ bản, đây là một cách để thực hiện một số GetNextRequests cùng một lúc, cho phép người dùng tạo danh sách tất cả dữ liệu và thông số có sẵn.
- `SetRequest` - Đây là lệnh do trình quản lý khởi xướng để đặt “Set” hoặc thay đổi “Change” giá trị của một tham số thông qua SNMP trên tác nhân thiết bị hoặc hệ thống. Loại tin nhắn này có thể được sử dụng để quản lý hoặc cập nhật cài đặt cấu hình hoặc các thông số khác.
- `Response` - Phản hồi là tin nhắn mà tác nhân thiết bị gửi khi có Yêu cầu “Request” từ Trình quản lý. Khi gửi phản hồi đối với yêu cầu loại GetRequest, gói tin chứa dữ liệu hoặc giá trị được yêu cầu sẽ được gửi đi. Trong trường hợp SetRequest, gói tin sẽ phản hồi với giá trị mới được thiết lập như một xác nhận rằng SetRequest đã được hoàn thành thành công.
- `Trap(v2)` - Một bẫy “trap” được gửi (“push out”) bởi tác nhân SNMP mà không cần trình quản lý yêu cầu. Thay vào đó, bẫy “trap” được gửi theo các điều kiện xác định, chẳng hạn như trong trường hợp có lỗi hoặc khi vượt qua ngưỡng đặt trước. Nếu người dùng muốn hưởng lợi từ các bẫy “trap” để giám sát, đây là một ý tưởng tuyệt vời về giám sát chủ động, trước tiên họ có thể phải định cấu hình các bẫy “trap” với sự trợ giúp của trình quản lý SNMP.
- `InformRequest` - Loại tin nhắn này đã được thêm vào SNMP v2 để cung cấp cho trình quản lý khả năng xác nhận rằng nó đã nhận được tin nhắn bẫy “trap” của tác nhân.
- `Report` - SNMP v3 là cần thiết để sử dụng chức năng tin nhắn Báo cáo “Report”. Chúng cho phép Trình quản lý SNMP xác định loại sự cố đã được phát hiện bởi tác nhân SNMP Agent từ xa.
<h2 style="color:orange">1.2. Cách thức truyền tải SNMP</h2>

- Hoạt động trên tầng 7 (Application Layer) của mô hình OSI.
- SNMP sử dụng Giao thức UDP (UDP - User Datagram Protocol) để truyền các tin nhắn thông điệp của mình. Điều cần thiết là các gói tin UDP packet có thể chuyển từ tác nhân “Agent” đến trình quản lý “Manager” để giám sát thành công. Điều này thường hoạt động theo mặc định trên mạng cục bộ nhưng cần có cấu hình bộ định tuyến bổ sung để cho phép các gói tin như vậy truyền qua các mạng rộng hơn.
- Các tác nhân SNMP Agent nhận các yêu cầu UDP Request trên port 161. Các yêu cầu được gửi từ trình quản lý SNMP có thể được gửi từ bất kỳ cổng nào. Thông thường, nó là 161. Các tác nhân Agent gửi bẫy “trap” qua cổng 162. Trình quản lý SNMP cũng nhận được bẫy “trap” trên cổng 162.
<h2 style="color:orange">2. OID VÀ MIB</h2>

OID (Object Identifier), tức là “Mã nhận diện đối tượng”. OID xác định duy nhất các đối tượng được quản lý được định nghĩa trong các tệp MIB.

Ví dụ:
Đây là cấu trúc mẫu của một OID:
 
    Iso(1).org(3).dod(6).internet(1).private(4).transition(868).products(2).chassis(4).card(1).slotCps(2)-cpsSlotSummary(1).cpsModuleTable(1).cpsModuleEntry(1).cpsModuleModel(3).3562.3
Hoặc chỉ cần
 
    1.3.6.1.4.868.2.4.1.2.1.1.1.3.3562.3
Có hai loại đối tượng: đối tượng vô hướng (scalar) và đối tượng dạng bảng (tabular). Các đối tượng vô hướng xác định một cá thể đối tượng duy nhất trong khi các đối tượng dạng bảng xác định nhiều cá thể đối tượng liên quan được nhóm trong các bảng MIB.

MIB (Management Information Base) - Cơ sở Thông tin Quản lý, và đề cập đến một định dạng độc lập để định nghĩa thông tin quản lý. Nói cách khác, MIB chứa các OID theo một cách được xác định rõ ràng. Trong MIB, mọi đối tượng đều nhận được định nghĩa xác định các thuộc tính của nó trong thiết bị được quản lý. Các đối tượng được truy cập bằng giao thức SNMP.

Cơ bản OID xác định thực thể được quản lý, còn MIB là nơi chưa OID.
<h2 style="color:orange">3. Lợi ích SNMP</h2>

1. Tổ chức tốt:
2. Cảnh báo, thông báo khi có sự cố
3. Báo cáo & thống kê
4. Lập kế hoạch trước: Phân tích dữ liệu sẽ hiển thị xu hướng cho các mạng riêng lẻ và cho phép lập kế hoạch trước. Kết quả mà bạn sẽ giành được là: độ tin cậy, tốc độ và hiệu quả.
5. Thiết lập cấu hình với sự thoải mái: Việc thiết lập giám sát cho các mạng lớn có thể rất tẻ nhạt và tốn thời gian. Các công cụ giám sát sẽ tự động hóa và tăng tốc độ đó cho người dùng và cung cấp, ví dụ, các tính năng tự động khám phá mạng linh hoạt hoặc các mẫu mặc định cho các sản phẩm cơ sở hạ tầng mạng được sử dụng rộng rãi.